<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buy/Sell Crypto</title>

    <!-- Favicon -->
    <link rel="icon" href="Logo.png" type="image/png">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .trade-enroll {
            font-style: italic;
            color: #ff69b4;
            margin-top: 20px;
            text-align: center;
        }

	    
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: url('BG.png') no-repeat center center;
            background-size: cover;
            background-attachment: fixed; /* Ensures background stays fixed when scrolling */
        }



        /* Navbar Styles */
        .navbar {
            background-color: #000;
        }

        .navbar-brand img {
            height: 40px;
            border-radius: 10%; /* Make logo round */
            margin-right: 10px;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #fff !important;
        }

        .nav-link {
            color: #fff !important;
            font-weight: bold; /* Bold text */
            margin: 0 10px;
        }

        .btn-connect {
            background-color: #ff1493;
            color: #fff;
            border: none;
        }

        .btn-connect:hover {
            background-color: #ff69b4;
        }

        .main-container {
            background-color: rgba(0, 0, 0, 0.5);
            padding: 30px;
            border-radius: 20px;
            width: 80%;
            max-width: 500px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
            text-align: center;
            margin: 0 auto; /* Center the container */
        }

        .btn-group {
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 24px;
            font-size: 1.4rem;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
        }

        .btn-buy {
            background-color: #28a745; /* Green */
            color: white;
        }

        .btn-sell {
            background-color: #ff1493; /* Pink */
            color: white;
        }

        .btn-active {
            background-color: #28a745; /* Green for Buy */
            color: white;
        }

        .btn-inactive {
            background-color: #aaa; /* Light gray for inactive buttons */
            color: white;
        }

        .btn-active-sell {
            background-color: #ff1493; /* Pink for Sell */
            color: white;
        }

        .btn:hover {
            transform: scale(1.1); /* Enlarge button slightly on hover */
        }

        .btn-active:hover {
            background-color: #218838; /* Darker green on hover */
        }

      .btn-inactive:hover {
            background-color: #ff1493; /* Darker green on hover */
        }

        .btn-active-sell:hover {
            background-color: #e6007f; /* Darker pink on hover */
        }

        .buy-sell-container {
            display: block; /* Default to show both sections */
        }

        .buy-container, .sell-container {
            display: none;
        }

        .buy-container.active, .sell-container.active {
            display: block;
        }

        .crypto-pair {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .image-container {
            background-color: #fff; /* White background */
            padding: 20px; /* Add some padding around the image */
            border-radius: 100%; /* Rounded corners */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center; /* Center the text */
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* Light shadow for depth */
            width: 100px; /* Set width to 150px */
            height: 100px; /* Set height to 150px to make it square */
        }

        .crypto-pair .image-container img {
            margin-top: 20px; 
            border-radius: 50%; /* Make the image circular */
            width: 70%; /* Set image width to fill the container */
            height: 70%; /* Set image height to fill the container */
            object-fit: cover; /* Ensure the image fits within the container */
        }

        .crypto-pair .image-container p {
            margin-top: 5px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .amount-field {
            position: relative;
            margin-bottom: 20px;
        }

        .amount-field input {
            width: 100%;
            padding: 14px;
            font-size: 1rem;
            margin: 10px 0;
            border-radius: 12px;
            border: 2px solid #ccc;
            background-color: #f8f9fa;
            color: #333;
            transition: border-color 0.3s ease;
        }

        .amount-field input:focus {
            outline: none;
            border-color: #28a745; /* Green on focus */
        }

        .amount-field label {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
            color: #999;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        /* When input is focused or not empty, move label to the top */
        .amount-field input:focus + label,
        .amount-field input:not(:placeholder-shown) + label {
            top: -10px;
            font-size: 0.9rem;
            color: #28a745;
        }

        .swap-btn {
            background-color: #ff69b4;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            width: 20%;
        }

 .swap-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            position: relative;
        }

        .swap-button:disabled:hover::after {
            content: "Connect Wallet to Swap";
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background-color: black;
            color: white;
            padding: 5px;
            border-radius: 5px;
            font-size: 12px;
            white-space: nowrap;
        }

        .swap-btn:hover {
            background-color: #ff1493;
        }

#disconnect-wallet{
            background-color: grey;
}

/* Footer Styles */
.footer {
    background-color: #000;
    padding: 20px 40px;
    color: black;
    font-family: Arial, sans-serif;
    font-weight: bold;
}

.footer-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap; /* For responsiveness */
    gap: 20px;
}

.footer-left {
    display: flex;
    align-items: center;
    background-color: #fff;
    padding: 10px 20px;
    border-radius: 10px;
    gap: 20px;
}

.footer-logo-img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
}

.footer-right {
    display: flex; /* Align items in a row */
    gap: 20px; /* Space between links */
    align-items: center; /* Optional: to center the links vertically */
}

.footer-link {
    color: #fff;
    text-decoration: none;
}

.footer-link:hover {
    text-decoration: underline;
}
    </style>
<link rel="stylesheet" href="header.css">
<link rel="stylesheet" href="footer.css">
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <img src="Logo.png" alt="Logo"> Freedy Daddy
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="refer.html">Refer & Earn</a></li>
                    <li class="nav-item"><a class="nav-link" href="working.html">Earn Millions $</a></li>
                </ul>
                <button class="btn btn-connect" id="connect-wallet">Connect Wallet</button>
                <button class="btn btn-connect" id="disconnect-wallet" style="display: none;"><b>Disconnect Wallet</b></button>
            </div>
        </div>
    </nav>

<br><br>

    <div class="main-container">
        <div class="btn-group">
            <button class="btn btn-buy btn-active" id="buyBtn">Buy</button>
            <button class="btn btn-sell btn-inactive" id="sellBtn">Sell</button>
        </div>

        <div class="buy-sell-container">
            <!-- Buy Container -->
            <div class="buy-container active" id="buyContainer">
                <div class="crypto-pair">
                    <div class="image-container">
                        <img id="TokenBuy" src="https://s2.coinmarketcap.com/static/img/coins/200x200/1839.png" alt="BNB">
                        <p>BNB</p>
                    </div>
                    <div class="image-container">
                        <img id="TokenSell" src="Logo.png" alt="Freedy">
                        <p>Freedy</p>
                    </div>
                </div>
                <div class="amount-field">
                    <input type="number" placeholder="" id="buyAmount">
                    <label for="buyAmount">BNB</label>
                </div>
                <div class="amount-field">
                    <input type="text" id="freedyAmount" placeholder="" readonly>
                    <label for="freedyAmount">Freedy</label>
                </div>
                <button class="swap-btn" id="buySwapBtn"><b>Swap</b></button>
		    <br><br>
		    <span class="trade-enroll"></span>
            </div>

            <!-- Sell Container -->
            <div class="sell-container" id="sellContainer">
                <div class="crypto-pair">
                    <div class="image-container">
                        <img id="TokenBuy" src="Logo.png" alt="Freedy">
                        <p>Freedy</p>
                    </div>
                    <div class="image-container">
                        <img id="TokenSell" src="https://s2.coinmarketcap.com/static/img/coins/200x200/1839.png" alt="BNB">
                        <p>BNB</p>
                    </div>
                </div>
                <div class="amount-field">
                    <input type="number" placeholder="" id="sellAmount">
                    <label for="sellAmount">Freedy</label>
                </div>
                <div class="amount-field">
                    <input type="text" id="bnbAmount" placeholder="" readonly>
                    <label for="bnbAmount">BNB</label>
                </div>
                <button class="swap-btn" id="sellSwapBtn"><b>Swap</b></button>

		    <br><br>
		    <span class="trade-enroll"></span>
            </div>
        </div>
    </div>

<br><br>

<!-- Footer Section -->
<footer class="footer">
    <div class="footer-container">
        <!-- Left Section -->
        <div class="footer-left">
            <div class="footer-logo">
                <img src="Logo.png" alt="Logo" class="footer-logo-img">
            </div>
            <div class="token-price">
                Price <span id="token-price"> ≈ $...</span> &nbsp;
                <img src="bnb.png" alt="BNB" class="footer-logo-img footer-bnb-img">
            </div>
        </div>

        <!-- Right Section -->
        <div class="footer-right">

            <button id="Metamask-Add">Add to Metamask</button>

            <div class="footer-divider"></div>
            <a href="#docs" class="footer-link">Tokenomics</a>

            <div class="footer-divider"></div>
            <a href="contact.html" class="footer-link">Press Kit</a>


            <div class="footer-divider"></div>
            <a href="contact.html" class="footer-link">Contact</a>

        </div>
    </div>
</footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script src="walletconnect.js"></script>



    <script>

        // Buy/Sell Toggle
        const buyBtn = document.getElementById('buyBtn');
        const sellBtn = document.getElementById('sellBtn');
        const buyContainer = document.getElementById('buyContainer');
        const sellContainer = document.getElementById('sellContainer');
let tokenBNBPrice=1;

        buyBtn.addEventListener('click', function() {
            buyContainer.classList.add('active');
            sellContainer.classList.remove('active');
            // Swap the images when "Buy" is clicked
            document.getElementById('TokenBuy').src = "https://s2.coinmarketcap.com/static/img/coins/200x200/1839.png"; // BNB
            document.getElementById('TokenSell').src = "Logo.png"; // Freedy

            // Change button colors
            buyBtn.classList.add('btn-active');
            buyBtn.classList.remove('btn-inactive');
            sellBtn.classList.add('btn-inactive');
            sellBtn.classList.remove('btn-active');
        });

        sellBtn.addEventListener('click', function() {
            sellContainer.classList.add('active');
            buyContainer.classList.remove('active');
            // Swap the images when "Sell" is clicked
            document.getElementById('TokenBuy').src = "Logo.png"; // Freedy
            document.getElementById('TokenSell').src = "https://s2.coinmarketcap.com/static/img/coins/200x200/1839.png"; // BNB

            // Change button colors
            sellBtn.classList.add('btn-active');
            sellBtn.classList.remove('btn-inactive');
            buyBtn.classList.add('btn-inactive');
            buyBtn.classList.remove('btn-active');
        });

        // Buy Calculation
        const buyAmountInput = document.getElementById('buyAmount');
        const freedyAmountInput = document.getElementById('freedyAmount');

        buyAmountInput.addEventListener('input', function() {
            const buyAmount = parseFloat(buyAmountInput.value);
            if (!isNaN(buyAmount)) {
                const freedyAmount = buyAmount / tokenBNBPrice; // Calculate Freedy tokens
                freedyAmountInput.value = freedyAmount.toFixed(2); // Display the calculated amount
            } else {
                freedyAmountInput.value = ''; // Clear the value if input is not a number
            }
        });

        // Sell Calculation
        const sellAmountInput = document.getElementById('sellAmount');
        const bnbAmountInput = document.getElementById('bnbAmount');

        sellAmountInput.addEventListener('input', function() {
            const sellAmount = parseFloat(sellAmountInput.value);
            if (!isNaN(sellAmount)) {
                const bnbAmount = sellAmount * tokenBNBPrice; // Calculate BNB amount
                bnbAmountInput.value = bnbAmount.toFixed(2); // Display the calculated amount
            } else {
                bnbAmountInput.value = ''; // Clear the value if input is not a number
            }
        });

        let walletAddress;

document.getElementById('connect-wallet').addEventListener('click', async () => {
    try {

        const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
        const networkId = await ethereum.request({ method: 'net_version' });

        // Check if the connected network is Binance Smart Chain (Mainnet or Testnet)
        if (networkId === '56' || networkId === '97') {
            walletAddress = accounts[0];

        walletConnected = true;
        //document.getElementById("wallet-address").textContent = "Wallet Address : " + walletAddress;
        document.getElementById('disconnect-wallet').style.display = 'inline';
        document.getElementById('connect-wallet').style.display = 'none';
	checkEnrollmentStatus(walletAddress);

        } else {
            // Display an error message if the connected network is not BSC
     //   flashNotification('Error: Connect to Binance Smart Chain', 'red');

        }
    } catch (error) {
        //flashNotification('Wallet Not Found', 'red');
	   // updateLog("Wallet Not Found", `❌ Home: ${error.message}`);
    }
});
document.addEventListener("DOMContentLoaded", function() {
	LoadDetails();

});
async function LoadDetails() {
    try {        
        if (typeof contract === "undefined") {
            console.error("Error: Contract is not initialized.");
            return;
        }

        const tokenPriceWei = await contract.methods.calculateTokenPrice().call();
        
        const tokenPriceInEther = web3.utils.fromWei(tokenPriceWei, 'ether');
        tokenBNBPrice = tokenPriceInEther;
        
        // Fetch BNB price from CoinGecko API
        const bnbPriceInUSD = await fetchBNBPrice();
        
        // Calculate equivalent USD values
        const tokenPriceInUSD = (bnbPriceInUSD * tokenPriceInEther).toFixed(2);
        tokenPrice = tokenPriceInUSD;

        // Update UI
        document.getElementById('token-price').innerText = `≈ $ ${tokenPriceInUSD}`;

    } catch (error) {
        console.error('Error in LoadDetails:', error);
    }
}

async function fetchBNBPrice() {
    try {
        const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=binancecoin&vs_currencies=usd');
        const data = await response.json();
        return data.binancecoin.usd;
    } catch (error) {
        console.error('Error fetching BNB price:', error);
        return 0; // Fallback in case of an error
    }
}

document.getElementById('buySwapBtn').addEventListener('click', async () => {

    const bnbAmount = parseFloat(document.getElementById('buyAmount').value);

    if (isNaN(bnbAmount) || bnbAmount <= 0) {
        alert('Please enter a valid amount in BNB');
        return;
    }

    const weiAmount = ethers.utils.parseUnits(bnbAmount.toString(), "ether");

    try {
        // Call the buy function
        const tx = await contract.methods.buy().send({ from: userAddress, value: weiAmount });
        console.log("Transaction sent: ", tx);

        // Optionally, wait for the transaction to be mined
        const receipt = await tx.wait();
        console.log("Transaction confirmed: ", receipt);

    } catch (error) {
        console.error("Error calling contract function: ", error);
    }


});


document.getElementById('sellSwapBtn').addEventListener('click', async () => {
    console.log("p2");
});


async function checkEnrollmentStatus(address) {
    if (!walletConnected) {
        flashNotification('Wallet not Connected', 'yellow');
        return;
    }

    if (typeof window.ethereum === 'undefined') {
        alert('MetaMask is not installed. Please install MetaMask and try again.');
        return;
    }

    try {
        const enrolledStatus = await contract.methods.isEnrolled(address).call();

        if (enrolledStatus) {
            console.log(`${address} is enrolled.`);
            
            document.querySelectorAll('.trade-enroll').forEach(el => {
                el.innerText = "You are Whitelisted for Pre Trading";
            });

        } else {
            console.log(`${address} is not enrolled.`);
            
            document.querySelectorAll('.trade-enroll').forEach(el => {
                el.innerText = "You are Not Whitelisted for Pre Trading. Enroll for Airdrop to be Eligible.";
            });  // **Missing parenthesis added here**
        }

    } catch (error) {
        console.error('Error checking enrollment status:', error);
        alert('Error checking enrollment status. Check the console for details.');
    }
}

    </script>
</body>
</html>
